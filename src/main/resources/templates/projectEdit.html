<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<div  th:fragment="projectEdit">
    <!--<link th:href="@{inspinia_admin/css/plugins/cropper/cropper.min.css}" rel="stylesheet"/>-->
    <!--<link th:href="@{inspinia_admin/css/plugins/select2/select2.min.css}" rel="stylesheet"/>-->
    <!--<link th:href="@{inspinia_admin/css/plugins/chosen/bootstrap-chosen.css}" rel="stylesheet"/>-->
    <link th:href="@{99/css/plugins/ladda/ladda-themeless.min.css}" rel="stylesheet"/>
    <link th:href="@{99/css/plugins/dropzone/dropzone.css}" rel="stylesheet"/>
    <script th:src="@{jquery.koala.js}" type="text/javascript"></script>

    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-lg-10">
            <h2>项目</h2>
            <ol class="breadcrumb">
                <li>
                    <a href="index.html">首页</a>
                </li>
                <li>
                    <a>系统设置</a>
                </li>
                <li class="active">
                    <strong>项目</strong>
                </li>
            </ol>
        </div>
    </div>

    <div class="wrapper wrapper-content animated fadeInRight ecommerce">

        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-content">
                        <form method="POST" class="form-horizontal">
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="nameForm"><label class="col-sm-2 control-label">项目名称<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="name" name="name" type="text" class="form-control"
                                                             maxlength="200" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="typeForm"><label class="col-sm-2 control-label">类型<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="type" id="type">
                                        <option value="" selected="selected">未选择</option>
                                        <option>办展</option>
                                        <option>特装</option>
                                        <option>标摊</option>
                                        <option>工装</option>
                                        <option>活动</option>
                                        <option>庆典</option>
                                        <option>赛事</option>
                                        <option>会议</option>
                                    </select>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="customerIdForm"><label class="col-sm-2 control-label">客户<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="customerId" id="customerId" disabled="disabled">
                                        <option value="" selected="selected">未选择</option>
                                        <option>option 1</option>
                                        <option>option 2</option>
                                        <option>option 3</option>
                                        <option>option 4</option>
                                    </select>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="campaignIdForm"><label class="col-sm-2 control-label">市场活动<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="campaignId" id="campaignId">
                                        <option value="" selected="selected">未选择</option>
                                        <option>option 1</option>
                                        <option>option 2</option>
                                        <option>option 3</option>
                                        <option>option 4</option>
                                    </select>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="codeForm"><label class="col-sm-2 control-label">项目编号</label>
                                <label class="col-sm-4 control-label" style="text-align: left" id="code" name="code">001</label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="budgetForm"><label class="col-sm-2 control-label">预算<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="budget" name="budget" type="text" class="form-control"
                                                             maxlength="20" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="exhibitionNumberForm" ><label class="col-sm-2 control-label">展位号<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="exhibitionNumber" name="exhibitionNumber" type="text" class="form-control"
                                                             maxlength="30" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="areaForm"><label class="col-sm-2 control-label">面积<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="area" name="area" type="text" class="form-control"
                                                             maxlength="30" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="setupTimeForm"><label class="col-sm-2 control-label">搭建时间<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="setupTime" name="setupTime" type="text" class="form-control"
                                                             maxlength="30" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="tearDownTimeForm" ><label class="col-sm-2 control-label">撤展时间<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="tearDownTime" name="tearDownTime" type="text" class="form-control"
                                                             maxlength="30" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="costForm"><label class="col-sm-2 control-label">项目成本<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="cost" name="cost" type="text" class="form-control"
                                                             maxlength="30" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="degreeOfImportanceForm"><label class="col-sm-2 control-label">重要程度<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="degreeOfImportance" id="degreeOfImportance">
                                        <option value="" selected="selected">未选择</option>
                                        <option>三星</option>
                                        <option>四星</option>
                                        <option>五星</option>
                                    </select>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="potentialForm"><label class="col-sm-2 control-label">项目潜力<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="potential" id="potential">
                                        <option value="" selected="selected">未选择</option>
                                        <option>10%</option>
                                        <option>30%</option>
                                        <option>50%</option>
                                        <option>60%</option>
                                        <option>80%</option>
                                        <option>100%</option>
                                    </select>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="designerIdForm"><label class="col-sm-2 control-label">设计师<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="designerId" id="designerId">
                                        <option value="" selected="selected">未选择</option>
                                        <option>1</option>
                                        <option>2</option>
                                        <option>3</option>
                                    </select>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">设计进度</label>
                                <div class="col-sm-4">
                                    <div class="checkbox checkbox-inline checkbox-info" >
                                        <input type="checkbox" name="designProgress" id="d1" />
                                        <label for="d1" >30%</label>
                                    </div>
                                    <div class="checkbox checkbox-inline checkbox-info" >
                                        <input type="checkbox" name="designProgress" id="d2" />
                                        <label for="d2" >60%</label>
                                    </div>
                                    <div class="checkbox checkbox-inline checkbox-info">
                                        <input type="checkbox" name="designProgress" id="d3" />
                                        <label for="d3" >100%</label>
                                    </div>
                                </div>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="pmIdForm"><label class="col-sm-2 control-label">项目经理<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="pmId" id="pmId">
                                        <option value="" selected="selected">未选择</option>
                                        <option>1</option>
                                        <option>2</option>
                                        <option>3</option>
                                    </select>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">项目进度</label>
                                <div class="col-sm-4">
                                    <div class="checkbox checkbox-inline checkbox-info" >
                                        <input type="checkbox" name="projectProgress" id="p1" />
                                        <label for="p1" >30%</label>
                                    </div>
                                    <div class="checkbox checkbox-inline checkbox-info" >
                                        <input type="checkbox" name="projectProgress" id="p2" />
                                        <label for="p2" >60%</label>
                                    </div>
                                    <div class="checkbox checkbox-inline checkbox-info">
                                        <input type="checkbox" name="projectProgress" id="p3" />
                                        <label for="p3" >100%</label>
                                    </div>
                                </div>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group"><label class="col-sm-2 control-label">工长<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="marketActivities">
                                        <option value="" selected="selected">未选择</option>
                                        <option>option 1</option>
                                        <option>option 2</option>
                                        <option>option 3</option>
                                        <option>option 4</option>
                                    </select>
                                </div>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">工厂进度</label>
                                <div class="col-sm-4">
                                    <div class="checkbox checkbox-inline checkbox-info" >
                                        <input type="checkbox" name="designProgress" id="f1" />
                                        <label for="f1" >30%</label>
                                    </div>
                                    <div class="checkbox checkbox-inline checkbox-info" >
                                        <input type="checkbox" name="factoryProgress" id="f2" />
                                        <label for="f2" >60%</label>
                                    </div>
                                    <div class="checkbox checkbox-inline checkbox-info">
                                        <input type="checkbox" name="designProgress" id="f3" />
                                        <label for="f3" >100%</label>
                                    </div>
                                </div>
                            </div>


                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="projectScoreForm"><label class="col-sm-2 control-label">项目评分<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="projectScore" name="projectScore" type="text" class="form-control"
                                                             maxlength="10" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="designScoreForm"><label class="col-sm-2 control-label">设计评分<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="designScore" name="designScore" type="text" class="form-control"
                                                             maxlength="10" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="pmScoreForm"><label class="col-sm-2 control-label">项目经理评分<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4"><input id="pmScore" name="pmScore" type="text" class="form-control"
                                                             maxlength="10" /></div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="developSaleIdForm"><label class="col-sm-2 control-label">开发销售<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="developSaleId" id="developSaleId">
                                        <option value="" selected="selected">未选择</option>
                                        <option>option 1</option>
                                        <option>option 2</option>
                                        <option>option 3</option>
                                        <option>option 4</option>
                                    </select>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <div class="form-group" id="traceSaleIdForm" ><label class="col-sm-2 control-label">跟进销售<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4">
                                    <select class="form-control m-b" name="traceSaleId" id="traceSaleId">
                                        <option value="" selected="selected">未选择</option>
                                        <option>option 1</option>
                                        <option>option 2</option>
                                        <option>option 3</option>
                                        <option>option 4</option>
                                    </select>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" ><label class="col-sm-2 control-label">项目图片<span
                                    style="color:#ed5565;">*</span></label>
                                <div class="col-sm-4 dropzone" id="photo">
                                    <div class="am-text-success dz-message row">
                                        将文件拖拽到此处或点此打开文件管理器选择文件
                                    </div>
                                </div>
                                <label class="col-sm-4 control-label" style="text-align: left"></label>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group"><label class="col-sm-2 control-label">状态</label>
                                <div class="col-sm-4">
                                    <div class="radio radio-inline radio-info">
                                        <input type="radio" name="state" id="s1" value="1" th:checked="${factory}?${factory.state eq 1}:'true'"/>
                                        <label for="s1">
                                            可用
                                        </label>
                                    </div>
                                    <div class="radio radio-inline radio-info">
                                        <input type="radio" name="state" id="s2" value="2" th:checked="${factory}?${factory.state eq 2}"/>
                                        <label for="s2">
                                            锁定
                                        </label>
                                    </div>
                                    <div class="radio radio-inline radio-info">
                                        <input type="radio" name="state" id="s3" value="3" th:checked="${factory}?${factory.state eq 3}"/>
                                        <label for="s3">
                                            禁用
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="hr-line-dashed"></div>



                            <div class="hr-line-dashed"/>
                            <div class="form-group">
                                <div class="col-sm-4 col-sm-offset-2">
                                    <button id="saveBtn" class="btn ladda-button btn-w-m btn-primary" data-style="zoom-in" type="button" onclick="saveProject(this);">
                                        <span class="ladda-label">保&nbsp;&nbsp;存</span>
                                    </button>
                                </div>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Image cropper -->
    <!--<script th:src="@{inspinia_admin/js/plugins/cropper/cropper.min.js}"></script>-->
    <!-- Data picker -->
    <script th:src="@{99/js/plugins/datapicker/bootstrap-datepicker.js}"></script>
    <script th:src="@{99/js/plugins/dropzone/dropzone.js}"></script>
    <script th:src="@{99/js/plugins/ladda/spin.min.js}"></script>
    <script th:src="@{99/js/plugins/ladda/ladda.min.js}"></script>

    <!-- Select2 -->
    <!--<script th:src="@{inspinia_admin/js/plugins/select2/select2.full.min.js}"></script>-->

    <!-- Chosen -->
    <!--<script th:src="@{inspinia_admin/js/plugins/chosen/chosen.jquery.js}"></script>-->
    <script th:src="@{me.js}" type="text/javascript"></script>

    <script type="text/javascript">
        /*<![CDATA[*/

        var photolist=[];
        var delPhotoList=[];


        $("#setting").addClass("active");
        $("#projectEdit").addClass("active");

        $('#setupTime').datepicker({
            startView: 1,
            todayBtn: "linked",
            keyboardNavigation: false,
            forceParse: false,
            autoclose: true,
            format: "yyyy-mm-dd",
            language: 'cn',
        });

        $('#tearDownTime').datepicker({
            startView: 1,
            todayBtn: "linked",
            keyboardNavigation: false,
            forceParse: false,
            autoclose: true,
            format: "yyyy-mm-dd",
            language: 'cn',
        });

        var previewTemplate = "<div class=\"dz-preview dz-file-preview\" onclick='showPicture(this)'>\n  " +
            "  <div class=\"dz-details\">\n" +
//            "  <img data-dz-thumbnail name='picture' style='width: 300px;height: 300px;display: none'/>\n" +
            "  </div>\n" +
            "<div class=\"dz-image\"><img data-dz-thumbnail style='width: 120px;height: 120px;'/></div>\n  " +
            "<div class=\"dz-progress\"><span class=\"dz-upload\" data-dz-uploadprogress></span></div>\n  " +
            "<div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n  " +
            "<div class=\"dz-success-mark\">\n    " +
//            "<svg width=\"54px\" height=\"54px\" viewBox=\"0 0 54 54\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:sketch=\"http://www.bohemiancoding.com/sketch/ns\">\n      <title>Check</title>\n      <defs></defs>\n      <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n        <path d=\"M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\" id=\"Oval-2\" stroke-opacity=\"0.198794158\" stroke=\"#747474\" fill-opacity=\"0.816519475\" fill=\"#FFFFFF\" sketch:type=\"MSShapeGroup\"></path>\n      </g>\n    </svg>\n  </div>\n  <div class=\"dz-error-mark\">\n    <svg width=\"54px\" height=\"54px\" viewBox=\"0 0 54 54\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:sketch=\"http://www.bohemiancoding.com/sketch/ns\">\n      <title>Error</title>\n      <defs></defs>\n      <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n        <g id=\"Check-+-Oval-2\" sketch:type=\"MSLayerGroup\" stroke=\"#747474\" stroke-opacity=\"0.198794158\" fill=\"#FFFFFF\" fill-opacity=\"0.816519475\">\n          <path d=\"M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\" id=\"Oval-2\" sketch:type=\"MSShapeGroup\"></path>\n        </g>\n      </g>\n    </svg>\n  " +
            "</div>\n</div>";

        $("#photo").dropzone({
            url: "fileupload",
            paramName: "files",
            addRemoveLinks: true,
            uploadMultiple:false,
            dictRemoveLinks: "x",
            dictCancelUpload: "x",
            maxFiles: 10,
            maxFilesize: 5,
            previewTemplate:previewTemplate ,
//            autoProcessQueue:false,
            acceptedFiles: ".jpg,.gif,.png", //上传的类型
            init:function(){
                var selectPhotoValue =  $("#selectphotoValue").val();
                if(selectPhotoValue!=""){
                    var list = selectPhotoValue.split(",");
                    for(var j= 0;j< list.length; j++){
                        photolist.push(list[j]);
                    }
                }
                for(var i=0;i<photolist.length;i++){
                    var mockFile = { name: photolist[i]};
                    this.emit("addedfile", mockFile);
                    this.emit("thumbnail", mockFile, "" +"upload/"+photolist[i]);
                    this.emit("complete", mockFile);
                }

                this.on("addedfile", function(file) {
                    //上传文件时触发的事件
                });
                this.on("success",function(file,response) {
                    //单个上传完成后触发的方法
                    file.serverName = response.url;
                    photolist.push(file.serverName);
                });
                this.on("queuecomplete",function(file) {
                    //上传完成后触发的方法
//                    $("#saveBtn").removeAttr("disabled");
                });
                this.on("removedfile",function(file){
                    //删除文件时触发的方法
                    if(file.serverName==undefined){
                        file.serverName=file.name;
                    }
                    for(var i=0;i<photolist.length;i++){
                        if(photolist[i]==file.serverName){
                            photolist.splice(i,1);
                            delPhotoList.push(file.serverName);
                            break;
                        }

                    }

                });
            }
        });

        validate('name', 'name', 'validateprojectName');
        validate2('mobilePhone', 'mobile', {isEdit: false}, 'validateMobile');
        validate('password', 'password', 'validatePassword');
//        validate('totalLessons', 'integer', 'validateInteger');
        validate('email', 'email', 'validateEmail');


        var saveBtnda;
        function saveProject(btn) {
            saveBtnda = Ladda.create( btn );
            var roles = [];
            $('input[name="role"]:checked').each(function () {
                roles.push({id: $(this).val().trim()});
            });
            var p = {
                id: $("#id").val().trim(),
//                nick: $("#nick").val().trim(),
                name: $("#name").val().trim(),
                mobilePhone: $("#mobilePhone").val().trim(),
                password: $("#password").val(),
                roleList: roles,
//                totalLessons: $("#totalLessons").val().trim(),

                state: $("input[name='state']:checked").val(),
                gender: $("input[name='gender']:checked").val(),
                email: $("#email").val().trim(),



            };
            var a = JSON.stringify(p);
            $.ajax({
                url: 'saveProject',
                async: true,
                type: 'POST',
                data: a,
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                timeout: 300000,
                beforeSend: function () {
                    saveBtnda.start();
                },
                error: function (result) {
                    alert("通信错误！");
                },
                success: function (data) {
                    if (data.res == undefined) {
                        saveBtnda.stop();
                        for (var p in data) {
                            var tmp = $("#" + data[p].field).parent().next();

                            if (tmp.text() == '') {
                                $("#" + data[p].field + "Form").addClass("has-error")
                                var tmp = $("#" + data[p].field).parent().next();
                                tmp.html(data[p].defaultMessage);
                            }
                        }
                    }else{

                        loadPage("projectList",function(){
                            saveBtnda.stop();
                        });
                    }
                }
            });
        }
        /*]]>*/
    </script>
</div>
</html>
